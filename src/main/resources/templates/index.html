<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<meta charset="utf-8">

<link th:href="@{/webjars/bootstrap/4.1.1/css/bootstrap.min.css}"
	rel="stylesheet"></link>
<script th:src="@{/webjars/jquery/3.3.1/jquery.min.js}"></script>
<script th:src="@{/webjars/bootstrap/4.1.1/js/bootstrap.min.js}"></script>
<title>Three Good Things</title>
<link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
	<header>
		<div class="wrapper flex-items">
			<div class="title">
				<p>Three good things</p>
			</div>
			<div class="hamburger-menu">

				<input type="checkbox" id="menu-btn-check"> <label
					for="menu-btn-check" class="menu-btn"><span></span></label>
				<!-- ここからメニュー -->
				<div class="menu-content">
					<ul>
						<li><a href="index.html">TODAY</a></li>
						<li><a href="#">カレンダー</a></li>
						<li><a href="postList.html">History</a></li>
						<li><a href="#">ユーザー</a></li>
					</ul>
				</div>
			</div>
			<div class="header-list">
				<ul>
					<li><a href="index.html">TODAY</a></li>
					<li><a href="#">カレンダー</a></li>
					<li><a href="postList.html">History</a></li>
					<li><a href="#">ユーザー</a></li>
				</ul>
			</div>
		</div>
	</header>
	<form name="myForm" method="post" th:action="@{/register}"
		th:object="${mainForm}">
		<div class="main">
			<div class="wrapper wrapper-in">
				<div class="date-move">
					<div class="date">
						<p th:text="*{#dates.format(date, 'yyyy年MM月dd日')}">10月30日</p>
					</div>
					<div class="move">
						<a class="yesterday" onclick="yesterday()"
							href="javascript:void(0)"></a> <a class="tomorrow"
							onclick="tomorrow()" href="javascript:void(0)"></a>
					</div>
					<div class="edit" style="display:none;">
						<button type="button" id="save" class="btn btn-sm btn-success">保存</button>
						<button type="button" id="cancel" class="btn btn-sm btn-light ml-2">キャンセル</button>
					</div>
				</div>
			</div>
		</div>
		<div class="display wrapper wrapper-in">
			<div class="input-area">
				<p>1</p>
				<a th:unless="*{good1}" id="good1" class="editBtn" href="#">タップして編集する</a>
				<a th:if="*{good1}" id="goodText1" class="goodText" href="#"
					th:text="*{good1}"></a>
				<p>2</p>
				<a th:unless="*{good2}" id="good2" class="editBtn" href="#">タップして編集する</a>
				<a th:if="*{good2}" id="goodText2" class="goodText" href="#"
					th:text="*{good2}"></a>
				<p>3</p>
				<a th:unless="*{good3}" id="good3" class="editBtn" href="#">タップして編集する</a>
				<a th:if="*{good3}" id="goodText3" class="goodText" href="#"
					th:text="*{good3}"></a>
			</div>
		</div>
		<div class="edit wrapper wrapper-in">
			<div class="input" id="input1" style="display: none;">
				<p>1</p>
				<textarea class="good" th:field="*{good1}" placeholder=""></textarea>
			</div>
			<div class="input" id="input2" style="display: none;">
				<p>2</p>
				<textarea class="good" th:field="*{good2}" placeholder=""></textarea>
			</div>
			<div class="input" id="input3" style="display: none;">
				<p>3</p>
				<textarea class="good" th:field="*{good3}" placeholder=""></textarea>
			</div>
			<input type="hidden" th:field="*{date}">
		</div>
	</form>
	<footer>
		<p>©︎ Three good things</p>
	</footer>
	<script type="text/javascript" th:inline="javascript">
		/*<![CDATA[*/
		function yesterday() {
			document.myForm.setAttribute("action", "/yesterday");
			document.myForm.setAttribute("method", "get");
			document.myForm.submit();
		}

		function tomorrow() {
			document.myForm.setAttribute("action", "/tomorrow");
			document.myForm.setAttribute("method", "get");
			document.myForm.submit();
		}

		$(function() {
			function editMode(obj) {
				var num = obj.id.slice(-1);
				$(".display").hide();
				$(".move").hide();
				$("#input" + num).show();
				var $textArea = $("#input" + num).find("textarea");
				$textArea.focus();
// 				$textArea.setSelectionRange(2, 5);
				$(".edit").show();
			}

			$(".editBtn").on("click", function(e) {
				editMode(this);
			});

			$(".goodText").on("click", function(e) {
				editMode(this);
			});

			$("#cancel").on("click", function(e){
				$(".display").show();
				$(".move").show();
				$(".input").hide();
				$(".edit").hide();
			});

// 			$(".good").on("change", function(e) {
// 				e.preventDefault();
// 				$.ajax({
// 					url : $("form").attr("action"),
// 					type : "POST",
// 					dataType : "json",
// 					data : {
// 						good1 : $("#good1").val(),
// 						good2 : $("#good2").val(),
// 						good3 : $("#good3").val(),
// 						date : $("#date").val(),
// 						_csrf : $("*[name=_csrf]").val()
// 					}
// 				}).done(function(data) {
// 					alert("登録が完了しました");
// 					alert("good1 : " + data.good1);
// 					alert("good2 : " + data.good2);
// 					alert("good3 : " + data.good3);
// 				}).fail(function() {
// 					alert("error!");
// 				});
// 			});
		});

		/*]]>*/
	</script>
</body>
<meta th:name="_csrf" th:content="${_csrf.token}" />
<meta th:name="_csrf_header" th:content="${_csrf.headerName}" />
</html>
